Before Norm

SELECT PersonName FROM salary_tracker WHERE BirthDate < '1975-01-01' AND Earnings = (SELECT MAX(Earnings) FROM salary_tracker WHERE PersonID = salary_tracker.PersonID) AND Earnings > 130000;
SELECT PersonName, SchoolName FROM salary_tracker WHERE Earnings > 400000 AND StillWorking = 'no';
SELECT PersonName FROM salary_tracker WHERE JobTitle = 'Lecturer' AND SchoolName = 'University of Texas' AND StillWorking = 'no';
SELECT SchoolName, SchoolCampus, COUNT(*) AS ActiveFacultyCount FROM salary_tracker WHERE StillWorking = 'yes' GROUP BY SchoolName, SchoolCampus ORDER BY ActiveFacultyCount DESC LIMIT 1;
SELECT PersonName, JobTitle, DepartmentName, SchoolName, MAX(Earnings) AS MostRecentEarnings FROM salary_tracker WHERE PersonName = 'Nikhil Premachandra Rao' GROUP BY PersonName, JobTitle, DepartmentName, SchoolName;
SELECT DepartmentName, AVG(Earnings) AS AverageEarnings FROM salary_tracker GROUP BY DepartmentName ORDER BY AverageEarnings DESC LIMIT 1;

After Norm

SELECT p.PersonName 
FROM Person p 
JOIN Employment e ON p.PersonID = e.PersonID 
WHERE p.BirthDate < '1975-01-01' 
AND e.Earnings = (SELECT MAX(Earnings) FROM Employment WHERE PersonID = p.PersonID) 
AND e.Earnings > 130000;

SELECT p.PersonName, s.SchoolName 
FROM Person p 
JOIN Employment e ON p.PersonID = e.PersonID 
JOIN School s ON p.PersonID = s.PersonID 
WHERE e.Earnings > 400000 AND e.StillWorking = 'no';

SELECT p.PersonName 
FROM Person p 
JOIN Employment e ON p.PersonID = e.PersonID 
WHERE e.JobTitle = 'Lecturer' AND s.SchoolName = 'University of Texas' AND e.StillWorking = 'no';

SELECT s.SchoolName, s.SchoolCampus, COUNT(*) AS ActiveFacultyCount 
FROM Employment e 
JOIN School s ON e.PersonID = s.PersonID 
WHERE e.StillWorking = 'yes' 
GROUP BY s.SchoolName, s.SchoolCampus 
ORDER BY ActiveFacultyCount DESC LIMIT 1;

SELECT p.PersonName, e.JobTitle, e.DepartmentName, s.SchoolName, MAX(e.Earnings) AS MostRecentEarnings 
FROM Person p 
JOIN Employment e ON p.PersonID = e.PersonID 
JOIN School s ON p.PersonID = s.PersonID 
WHERE p.PersonName = 'Nikhil Premachandra Rao' 
GROUP BY p.PersonName, e.JobTitle, e.DepartmentName, s.SchoolName;

SELECT e.DepartmentName, AVG(e.Earnings) AS AverageEarnings 
FROM Employment e 
GROUP BY e.DepartmentName 
ORDER BY AverageEarnings DESC LIMIT 1;









df = pd.read_csv('csv_query_performance_benchmark/datasets/salary_tracker_1MB.csv')
